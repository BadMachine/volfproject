{"ast":null,"code":"import * as instancesVal from '../instances_val2017.json';\n\nconst parseCategories = () => {\n  const classesTemp = [];\n  instancesVal.categories.forEach(item => {\n    if (!(item.supercategory in classesTemp)) {\n      classesTemp[item.supercategory] = [];\n    }\n\n    if (!(item.name in classesTemp[item.supercategory])) {\n      classesTemp[item.supercategory].push(item.name);\n    }\n  });\n  return classesTemp;\n};\n\nexport const classes = parseCategories();\nexport const parseSubCategories = supercategory => {\n  if (supercategory === 'all') {\n    console.log('qqqq');\n    console.log(Object.values(classes).flat());\n    return Object.values(classes).flat();\n  } else return classes[supercategory];\n};\n\nfunction fetchBboxesAndSegments(imageID) {\n  const bboxes = [];\n  const segments = [];\n  const annotationForImage = instancesVal.annotations.filter(annotation => annotation.image_id === imageID);\n  annotationForImage.forEach(annotation => {\n    bboxes.push({\n      box: annotation.bbox,\n      category: instancesVal.categories.find(item => item.id === annotation.category_id).name\n    });\n    segments.push({\n      area: annotation.area,\n      segments: annotation.segmentation,\n      category: instancesVal.categories.find(item => item.id === annotation.category_id).name\n    });\n  });\n  return {\n    bboxes: bboxes,\n    segments: segments\n  };\n}\n\nexport const getRandomCocoExample = () => {\n  const random = Math.round(Math.random() * instancesVal.images.length);\n  const image = instancesVal.images[random];\n  return {\n    filename: image.file_name,\n    path: 'C:\\\\',\n    url: image.coco_url,\n    height: image.height,\n    width: image.width,\n    info: fetchBboxesAndSegments(image.id),\n    showBboxes: false,\n    showKeypoints: false\n  };\n};\nexport const getFilteredCocoExample = filter => {\n  let classesToSearch;\n\n  if (filter.subclasses.length > 0) {\n    console.log('subclass > 0');\n    classesToSearch = instancesVal.categories.filter(category => filter.subclasses.includes(category.name)).map(classes => classes.id);\n    console.log(classesToSearch);\n  } else {\n    classesToSearch = filter.superclass === 'all' ? instancesVal.categories.map(classes => classes.id) : instancesVal.categories.filter(category => category.supercategory === filter.superclass).map(item => item.id);\n  } // if(filter.subclasses.length>0 ){\n  // \tclassesToSearch = (<any>instancesVal).categories.filter((category: any)=> filter.subclasses.includes(category.name) );\n  // }\n\n\n  const images_filtered_by_size = filter.image.width > 0 && filter.image.height > 0 ? instancesVal.images.filter(image => image.height <= filter.image.height).map(image => ({\n    url: image.coco_url,\n    id: image.id,\n    width: image.width,\n    height: image.height,\n    license: image.license\n  })) : instancesVal.images.map(image => ({\n    url: image.coco_url,\n    id: image.id,\n    width: image.width,\n    height: image.height,\n    license: image.license\n  }));\n  const annos_filtered_by_ClHs = instancesVal.annotations.filter(annotation => classesToSearch.includes(annotation.category_id) && images_filtered_by_size.map(image => image.id).includes(annotation.image_id));\n  let annos_filtered_by_bbox_shape;\n\n  if (filter.only === 1 || filter.only === 3) {\n    annos_filtered_by_bbox_shape = filter.bboxes.maxWidth > 0 && filter.bboxes.maxHeight > 0 ? annos_filtered_by_ClHs.filter(anno => Math.abs(anno.bbox[2] - anno.bbox[0]) <= filter.bboxes.maxWidth && Math.abs(anno.bbox[3] - anno.bbox[1]) <= filter.bboxes.maxHeight) : annos_filtered_by_ClHs;\n    annos_filtered_by_bbox_shape = filter.bboxes.minWidth > 0 && filter.bboxes.minHeight > 0 ? annos_filtered_by_bbox_shape.filter(anno => Math.abs(anno.bbox[0] - anno.bbox[2]) >= filter.bboxes.minWidth && filter.bboxes.minHeight <= Math.abs(anno.bbox[1] - anno.bbox[3])) : annos_filtered_by_bbox_shape;\n  } else annos_filtered_by_bbox_shape = annos_filtered_by_ClHs;\n\n  let resultImages = images_filtered_by_size.filter(image => annos_filtered_by_bbox_shape.map(anno => anno.image_id).includes(image.id));\n  resultImages = resultImages.map(image => ({\n    url: image.url,\n    id: image.id,\n    width: image.width,\n    height: image.height,\n    license: instancesVal.licenses.find(license => license.id === image.license).name\n  }));\n  resultImages = resultImages.map(image => ({\n    filename: image.url.split('/')[4],\n    path: filter.path + image.url.split('/')[4],\n    url: image.url,\n    width: image.width,\n    height: image.height,\n    license: image.license,\n    info: {\n      bboxes: filter.only === 1 || filter.only === 3 ? annos_filtered_by_bbox_shape.filter(anno => anno.image_id === image.id).map(item => ({\n        box: item.bbox,\n        category: instancesVal.categories.find(category => category.id === item.category_id).name\n      })) : [],\n      segments: filter.only === 2 || filter.only === 3 ? annos_filtered_by_bbox_shape.filter(anno => anno.image_id === image.id).map(item => ({\n        area: item.area,\n        segments: item.segmentation,\n        category: instancesVal.categories.find(category => category.id === item.category_id).name\n      })) : []\n    },\n    showBboxes: filter.only === 1 || filter.only === 3,\n    showKeypoints: filter.only === 2 || filter.only === 3\n  })); //console.log('FILTER');\n\n  const random = Math.round(Math.random() * resultImages.length); //console.log(resultImages[random]);\n\n  console.log(resultImages.find((item, index) => item.info.bboxes[index].category !== item.info.bboxes[index + 1].category));\n  return resultImages[random];\n};","map":{"version":3,"sources":["C:/Users/Bumpy/WebstormProjects/volfproject/src/components/cocoParser.ts"],"names":["instancesVal","parseCategories","classesTemp","categories","forEach","item","supercategory","name","push","classes","parseSubCategories","console","log","Object","values","flat","fetchBboxesAndSegments","imageID","bboxes","segments","annotationForImage","annotations","filter","annotation","image_id","box","bbox","category","find","id","category_id","area","segmentation","getRandomCocoExample","random","Math","round","images","length","image","filename","file_name","path","url","coco_url","height","width","info","showBboxes","showKeypoints","getFilteredCocoExample","classesToSearch","subclasses","includes","map","superclass","images_filtered_by_size","license","annos_filtered_by_ClHs","annos_filtered_by_bbox_shape","only","maxWidth","maxHeight","anno","abs","minWidth","minHeight","resultImages","licenses","split","index"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport * as instancesVal from '../instances_val2017.json';\r\nimport {randomColor} from '../interfaces/SortInterfaces';\r\nimport {filterData} from './classesCOCO';\r\n\r\nconst parseCategories=()=> {\r\n\tconst classesTemp:any = [];\r\n\t(<any>instancesVal).categories.forEach((item: any) => {\r\n\r\n\t\tif (!(item.supercategory in classesTemp)) {\r\n\t\t\tclassesTemp[item.supercategory] = [];\r\n\t\t}\r\n\t\tif (!(item.name in classesTemp[item.supercategory])) {\r\n\t\t\tclassesTemp[item.supercategory].push(item.name);\r\n\t\t}\r\n\t});\r\n\treturn classesTemp;\r\n};\r\nexport const classes = parseCategories();\r\n\r\nexport const parseSubCategories = (supercategory: string)=>{\r\n\r\n\tif(supercategory==='all') {\r\n\t\tconsole.log('qqqq');\r\n\t\tconsole.log(Object.values(classes).flat());\r\n\t\treturn Object.values(classes).flat();\r\n\t}\r\n\telse return classes[supercategory];\r\n};\r\n\r\n\r\nfunction fetchBboxesAndSegments(imageID:number){\r\n\tconst bboxes:any = [];\r\n\tconst segments:any = [];\r\n\r\n\tconst annotationForImage = (<any>instancesVal).annotations.filter((annotation: any) => annotation.image_id === imageID);\r\n\tannotationForImage.forEach((annotation:any)=>{\r\n\t\tbboxes.push({box: annotation.bbox, category: (<any>instancesVal).categories.find((item: any)=> item.id ===annotation.category_id).name});\r\n\t\tsegments.push({area: annotation.area, segments: annotation.segmentation, category: (<any>instancesVal).categories.find((item: any)=> item.id ===annotation.category_id).name   });\r\n\t});\r\n\treturn {bboxes: bboxes, segments: segments};\r\n\r\n}\r\n\r\n\r\nexport const getRandomCocoExample = ()=>{\r\n\r\n\tconst random = Math.round(Math.random() * ((<any>instancesVal).images.length));\r\n\tconst image = (<any>instancesVal).images[random];\r\n\r\n\treturn {\r\n\t\tfilename: image.file_name,\r\n\t\tpath: 'C:\\\\',\r\n\t\turl: image.coco_url,\r\n\t\theight: image.height,\r\n\t\twidth: image.width,\r\n\t\tinfo: fetchBboxesAndSegments(image.id),\r\n\t\tshowBboxes: false,\r\n\t\tshowKeypoints: false\r\n\t};\r\n\r\n\r\n};\r\n\r\nexport const getFilteredCocoExample = (filter: filterData) =>{\r\n\tlet classesToSearch: any;\r\n\r\n\tif(filter.subclasses.length>0 ){\r\n\t\tconsole.log('subclass > 0');\r\n\t\tclassesToSearch = (<any>instancesVal).categories.filter((category: any)=> filter.subclasses.includes(category.name) ).map((classes:any)=>classes.id);\r\n\t\tconsole.log(classesToSearch);\r\n\t}else {\r\n\t\tclassesToSearch = (filter.superclass === 'all') ? (<any>instancesVal).categories.map((classes: any) => classes.id)\r\n\t\t\t:\r\n\t\t\t(<any>instancesVal).categories.filter((category: any) => category.supercategory === filter.superclass).map((item: any) => item.id);\r\n\t}\r\n\t// if(filter.subclasses.length>0 ){\r\n\t// \tclassesToSearch = (<any>instancesVal).categories.filter((category: any)=> filter.subclasses.includes(category.name) );\r\n\t// }\r\n\r\n\tconst images_filtered_by_size = (filter.image.width>0 && filter.image.height>0) ?\r\n\t\t(<any>instancesVal).images.filter((image:any)=> image.height<=filter.image.height).map((image:any)=> ({url:image.coco_url, id: image.id, width: image.width, height: image.height, license: image.license}))\r\n\t\t:\r\n\t\t(<any>instancesVal).images.map((image:any)=> ({url: image.coco_url, id: image.id, width: image.width, height: image.height, license: image.license}));\r\n\r\n\tconst annos_filtered_by_ClHs = (<any>instancesVal).annotations.filter((annotation:any)=>\r\n\t\tclassesToSearch.includes(annotation.category_id) && images_filtered_by_size.map((image:any)=> image.id).includes(annotation.image_id) );\r\n\r\n\tlet annos_filtered_by_bbox_shape:any;\r\n\tif(filter.only===1 || filter.only===3) {\r\n\t\tannos_filtered_by_bbox_shape = (filter.bboxes.maxWidth > 0 && filter.bboxes.maxHeight > 0) ?\r\n\t\t\tannos_filtered_by_ClHs.filter((anno:any) => Math.abs(anno.bbox[2] - anno.bbox[0]) <= filter.bboxes.maxWidth && Math.abs(anno.bbox[3] - anno.bbox[1]) <= filter.bboxes.maxHeight )\r\n\t\t\t:\r\n\t\t\tannos_filtered_by_ClHs;\r\n\r\n\t\tannos_filtered_by_bbox_shape = (filter.bboxes.minWidth > 0 && filter.bboxes.minHeight > 0) ?\r\n\t\t\tannos_filtered_by_bbox_shape.filter((anno:any) => Math.abs(anno.bbox[0] - anno.bbox[2]) >= filter.bboxes.minWidth && filter.bboxes.minHeight <= Math.abs(anno.bbox[1] - anno.bbox[3]))\r\n\t\t\t:\r\n\t\t\tannos_filtered_by_bbox_shape;\r\n\t}else annos_filtered_by_bbox_shape = annos_filtered_by_ClHs;\r\n\r\n\tlet resultImages = images_filtered_by_size.filter((image:any)=>  annos_filtered_by_bbox_shape.map((anno:any)=> anno.image_id).includes(image.id) );\r\n\r\n\tresultImages = resultImages.map((image:any)=> ({ url:image.url, id: image.id, width: image.width, height: image.height, license: (<any>instancesVal).licenses.find((license:any) => license.id === image.license).name }));\r\n\r\n\tresultImages = resultImages.map((image:any) => ({\r\n\t\tfilename: image.url.split('/')[4],\r\n\t\tpath: filter.path+image.url.split('/')[4],\r\n\t\turl: image.url,\r\n\t\twidth: image.width,\r\n\t\theight: image.height,\r\n\t\tlicense: image.license,\r\n\t\tinfo:{\r\n\t\t\tbboxes: (filter.only===1 || filter.only===3)? annos_filtered_by_bbox_shape.filter((anno:any) => anno.image_id === image.id).map((item:any)=>({box:item.bbox, category: (<any>instancesVal).categories.find((category:any)=> category.id === item.category_id).name})) : [],\r\n\t\t\tsegments: (filter.only===2 || filter.only===3)? annos_filtered_by_bbox_shape.filter((anno:any) => anno.image_id === image.id).map((item:any)=>({area: item.area, segments:item.segmentation, category: (<any>instancesVal).categories.find((category:any)=> category.id === item.category_id).name})) : []\r\n\t\t},\r\n\t\tshowBboxes: filter.only===1 || filter.only===3,\r\n\t\tshowKeypoints: filter.only===2 || filter.only===3\r\n\t}) );\r\n\t//console.log('FILTER');\r\n\tconst random = Math.round(Math.random() * resultImages.length);\r\n\t//console.log(resultImages[random]);\r\n\tconsole.log(resultImages.find((item:any,index:number)=> item.info.bboxes[index].category!==item.info.bboxes[index+1].category));\r\n\treturn resultImages[random];\r\n\r\n};\r\n\r\n"]},"metadata":{},"sourceType":"module"}
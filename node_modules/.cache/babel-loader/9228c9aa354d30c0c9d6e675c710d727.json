{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.MathML = void 0;\n\nvar InputJax_js_1 = require(\"../core/InputJax.js\");\n\nvar Options_js_1 = require(\"../util/Options.js\");\n\nvar FunctionList_js_1 = require(\"../util/FunctionList.js\");\n\nvar FindMathML_js_1 = require(\"./mathml/FindMathML.js\");\n\nvar MathMLCompile_js_1 = require(\"./mathml/MathMLCompile.js\");\n\nvar MathML = function (_super) {\n  __extends(MathML, _super);\n\n  function MathML(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var _this = this;\n\n    var _a = __read(Options_js_1.separateOptions(options, FindMathML_js_1.FindMathML.OPTIONS, MathMLCompile_js_1.MathMLCompile.OPTIONS), 3),\n        mml = _a[0],\n        find = _a[1],\n        compile = _a[2];\n\n    _this = _super.call(this, mml) || this;\n    _this.findMathML = _this.options['FindMathML'] || new FindMathML_js_1.FindMathML(find);\n    _this.mathml = _this.options['MathMLCompile'] || new MathMLCompile_js_1.MathMLCompile(compile);\n    _this.mmlFilters = new FunctionList_js_1.FunctionList();\n    return _this;\n  }\n\n  MathML.prototype.setAdaptor = function (adaptor) {\n    _super.prototype.setAdaptor.call(this, adaptor);\n\n    this.findMathML.adaptor = adaptor;\n    this.mathml.adaptor = adaptor;\n  };\n\n  MathML.prototype.setMmlFactory = function (mmlFactory) {\n    _super.prototype.setMmlFactory.call(this, mmlFactory);\n\n    this.mathml.setMmlFactory(mmlFactory);\n  };\n\n  Object.defineProperty(MathML.prototype, \"processStrings\", {\n    get: function () {\n      return false;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  MathML.prototype.compile = function (math, document) {\n    var mml = math.start.node;\n\n    if (!mml || !math.end.node || this.options['forceReparse'] || this.adaptor.kind(mml) === '#text') {\n      var mathml = this.executeFilters(this.preFilters, math, document, math.math || '<math></math>');\n      var doc = this.checkForErrors(this.adaptor.parse(mathml, 'text/' + this.options['parseAs']));\n      var body = this.adaptor.body(doc);\n\n      if (this.adaptor.childNodes(body).length !== 1) {\n        this.error('MathML must consist of a single element');\n      }\n\n      mml = this.adaptor.remove(this.adaptor.firstChild(body));\n\n      if (this.adaptor.kind(mml).replace(/^[a-z]+:/, '') !== 'math') {\n        this.error('MathML must be formed by a <math> element, not <' + this.adaptor.kind(mml) + '>');\n      }\n    }\n\n    mml = this.executeFilters(this.mmlFilters, math, document, mml);\n    return this.executeFilters(this.postFilters, math, document, this.mathml.compile(mml));\n  };\n\n  MathML.prototype.checkForErrors = function (doc) {\n    var err = this.adaptor.tags(this.adaptor.body(doc), 'parsererror')[0];\n\n    if (err) {\n      if (this.adaptor.textContent(err) === '') {\n        this.error('Error processing MathML');\n      }\n\n      this.options['parseError'].call(this, err);\n    }\n\n    return doc;\n  };\n\n  MathML.prototype.error = function (message) {\n    throw new Error(message);\n  };\n\n  MathML.prototype.findMath = function (node) {\n    return this.findMathML.findMath(node);\n  };\n\n  MathML.NAME = 'MathML';\n  MathML.OPTIONS = Options_js_1.defaultOptions({\n    parseAs: 'html',\n    forceReparse: false,\n    FindMathML: null,\n    MathMLCompile: null,\n    parseError: function (node) {\n      this.error(this.adaptor.textContent(node).replace(/\\n.*/g, ''));\n    }\n  }, InputJax_js_1.AbstractInputJax.OPTIONS);\n  return MathML;\n}(InputJax_js_1.AbstractInputJax);\n\nexports.MathML = MathML;","map":{"version":3,"sources":["../../ts/input/mathml.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MathML = void 0;\nvar InputJax_js_1 = require(\"../core/InputJax.js\");\nvar Options_js_1 = require(\"../util/Options.js\");\nvar FunctionList_js_1 = require(\"../util/FunctionList.js\");\nvar FindMathML_js_1 = require(\"./mathml/FindMathML.js\");\nvar MathMLCompile_js_1 = require(\"./mathml/MathMLCompile.js\");\nvar MathML = (function (_super) {\n    __extends(MathML, _super);\n    function MathML(options) {\n        if (options === void 0) { options = {}; }\n        var _this = this;\n        var _a = __read(Options_js_1.separateOptions(options, FindMathML_js_1.FindMathML.OPTIONS, MathMLCompile_js_1.MathMLCompile.OPTIONS), 3), mml = _a[0], find = _a[1], compile = _a[2];\n        _this = _super.call(this, mml) || this;\n        _this.findMathML = _this.options['FindMathML'] || new FindMathML_js_1.FindMathML(find);\n        _this.mathml = _this.options['MathMLCompile'] || new MathMLCompile_js_1.MathMLCompile(compile);\n        _this.mmlFilters = new FunctionList_js_1.FunctionList();\n        return _this;\n    }\n    MathML.prototype.setAdaptor = function (adaptor) {\n        _super.prototype.setAdaptor.call(this, adaptor);\n        this.findMathML.adaptor = adaptor;\n        this.mathml.adaptor = adaptor;\n    };\n    MathML.prototype.setMmlFactory = function (mmlFactory) {\n        _super.prototype.setMmlFactory.call(this, mmlFactory);\n        this.mathml.setMmlFactory(mmlFactory);\n    };\n    Object.defineProperty(MathML.prototype, \"processStrings\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    MathML.prototype.compile = function (math, document) {\n        var mml = math.start.node;\n        if (!mml || !math.end.node || this.options['forceReparse'] || this.adaptor.kind(mml) === '#text') {\n            var mathml = this.executeFilters(this.preFilters, math, document, math.math || '<math></math>');\n            var doc = this.checkForErrors(this.adaptor.parse(mathml, 'text/' + this.options['parseAs']));\n            var body = this.adaptor.body(doc);\n            if (this.adaptor.childNodes(body).length !== 1) {\n                this.error('MathML must consist of a single element');\n            }\n            mml = this.adaptor.remove(this.adaptor.firstChild(body));\n            if (this.adaptor.kind(mml).replace(/^[a-z]+:/, '') !== 'math') {\n                this.error('MathML must be formed by a <math> element, not <' + this.adaptor.kind(mml) + '>');\n            }\n        }\n        mml = this.executeFilters(this.mmlFilters, math, document, mml);\n        return this.executeFilters(this.postFilters, math, document, this.mathml.compile(mml));\n    };\n    MathML.prototype.checkForErrors = function (doc) {\n        var err = this.adaptor.tags(this.adaptor.body(doc), 'parsererror')[0];\n        if (err) {\n            if (this.adaptor.textContent(err) === '') {\n                this.error('Error processing MathML');\n            }\n            this.options['parseError'].call(this, err);\n        }\n        return doc;\n    };\n    MathML.prototype.error = function (message) {\n        throw new Error(message);\n    };\n    MathML.prototype.findMath = function (node) {\n        return this.findMathML.findMath(node);\n    };\n    MathML.NAME = 'MathML';\n    MathML.OPTIONS = Options_js_1.defaultOptions({\n        parseAs: 'html',\n        forceReparse: false,\n        FindMathML: null,\n        MathMLCompile: null,\n        parseError: function (node) {\n            this.error(this.adaptor.textContent(node).replace(/\\n.*/g, ''));\n        }\n    }, InputJax_js_1.AbstractInputJax.OPTIONS);\n    return MathML;\n}(InputJax_js_1.AbstractInputJax));\nexports.MathML = MathML;\n//# sourceMappingURL=mathml.js.map"]},"metadata":{},"sourceType":"script"}
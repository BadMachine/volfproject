{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CommonMsubsupMixin = exports.CommonMsupMixin = exports.CommonMsubMixin = void 0;\n\nfunction CommonMsubMixin(Base) {\n  return function (_super) {\n    __extends(class_1, _super);\n\n    function class_1() {\n      return _super !== null && _super.apply(this, arguments) || this;\n    }\n\n    Object.defineProperty(class_1.prototype, \"script\", {\n      get: function () {\n        return this.childNodes[this.node.sub];\n      },\n      enumerable: false,\n      configurable: true\n    });\n\n    class_1.prototype.getOffset = function (bbox, sbox) {\n      return [0, -this.getV(bbox, sbox)];\n    };\n\n    return class_1;\n  }(Base);\n}\n\nexports.CommonMsubMixin = CommonMsubMixin;\n\nfunction CommonMsupMixin(Base) {\n  return function (_super) {\n    __extends(class_2, _super);\n\n    function class_2() {\n      return _super !== null && _super.apply(this, arguments) || this;\n    }\n\n    Object.defineProperty(class_2.prototype, \"script\", {\n      get: function () {\n        return this.childNodes[this.node.sup];\n      },\n      enumerable: false,\n      configurable: true\n    });\n\n    class_2.prototype.getOffset = function (bbox, sbox) {\n      var x = this.baseCore.bbox.ic ? .05 * this.baseCore.bbox.ic + .05 : 0;\n      return [x * this.coreScale(), this.getU(bbox, sbox)];\n    };\n\n    return class_2;\n  }(Base);\n}\n\nexports.CommonMsupMixin = CommonMsupMixin;\n\nfunction CommonMsubsupMixin(Base) {\n  return function (_super) {\n    __extends(class_3, _super);\n\n    function class_3() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n\n      _this.UVQ = null;\n      return _this;\n    }\n\n    Object.defineProperty(class_3.prototype, \"subChild\", {\n      get: function () {\n        return this.childNodes[this.node.sub];\n      },\n      enumerable: false,\n      configurable: true\n    });\n    Object.defineProperty(class_3.prototype, \"supChild\", {\n      get: function () {\n        return this.childNodes[this.node.sup];\n      },\n      enumerable: false,\n      configurable: true\n    });\n\n    class_3.prototype.computeBBox = function (bbox, recompute) {\n      if (recompute === void 0) {\n        recompute = false;\n      }\n\n      var basebox = this.baseChild.getBBox();\n      var subbox = this.subChild.getBBox();\n      var supbox = this.supChild.getBBox();\n      bbox.empty();\n      bbox.append(basebox);\n      var w = bbox.w;\n\n      var _a = __read(this.getUVQ(basebox, subbox, supbox), 2),\n          u = _a[0],\n          v = _a[1];\n\n      var x = this.baseCore.bbox.ic ? this.coreIC() * this.coreScale() : 0;\n      bbox.combine(subbox, w, v);\n      bbox.combine(supbox, w + x, u);\n      bbox.w += this.font.params.scriptspace;\n      bbox.clean();\n      this.setChildPWidths(recompute);\n    };\n\n    class_3.prototype.getUVQ = function (basebox, subbox, supbox) {\n      if (this.UVQ) return this.UVQ;\n      var tex = this.font.params;\n      var t = 3 * tex.rule_thickness;\n      var subscriptshift = this.length2em(this.node.attributes.get('subscriptshift'), tex.sub2);\n      var drop = this.isCharBase() ? 0 : basebox.d * basebox.rscale + tex.sub_drop * subbox.rscale;\n\n      var _a = __read([this.getU(basebox, supbox), Math.max(drop, subscriptshift)], 2),\n          u = _a[0],\n          v = _a[1];\n\n      var q = u - supbox.d * supbox.rscale - (subbox.h * subbox.rscale - v);\n\n      if (q < t) {\n        v += t - q;\n        var p = 4 / 5 * tex.x_height - (u - supbox.d * supbox.rscale);\n\n        if (p > 0) {\n          u += p;\n          v -= p;\n        }\n      }\n\n      u = Math.max(this.length2em(this.node.attributes.get('superscriptshift'), u), u);\n      v = Math.max(this.length2em(this.node.attributes.get('subscriptshift'), v), v);\n      q = u - supbox.d * supbox.rscale - (subbox.h * subbox.rscale - v);\n      this.UVQ = [u, -v, q];\n      return this.UVQ;\n    };\n\n    return class_3;\n  }(Base);\n}\n\nexports.CommonMsubsupMixin = CommonMsubsupMixin;","map":{"version":3,"sources":["../../../../ts/output/common/Wrappers/msubsup.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.CommonMsubsupMixin = exports.CommonMsupMixin = exports.CommonMsubMixin = void 0;\nfunction CommonMsubMixin(Base) {\n    return (function (_super) {\n        __extends(class_1, _super);\n        function class_1() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        Object.defineProperty(class_1.prototype, \"script\", {\n            get: function () {\n                return this.childNodes[this.node.sub];\n            },\n            enumerable: false,\n            configurable: true\n        });\n        class_1.prototype.getOffset = function (bbox, sbox) {\n            return [0, -this.getV(bbox, sbox)];\n        };\n        return class_1;\n    }(Base));\n}\nexports.CommonMsubMixin = CommonMsubMixin;\nfunction CommonMsupMixin(Base) {\n    return (function (_super) {\n        __extends(class_2, _super);\n        function class_2() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        Object.defineProperty(class_2.prototype, \"script\", {\n            get: function () {\n                return this.childNodes[this.node.sup];\n            },\n            enumerable: false,\n            configurable: true\n        });\n        class_2.prototype.getOffset = function (bbox, sbox) {\n            var x = (this.baseCore.bbox.ic ? .05 * this.baseCore.bbox.ic + .05 : 0);\n            return [x * this.coreScale(), this.getU(bbox, sbox)];\n        };\n        return class_2;\n    }(Base));\n}\nexports.CommonMsupMixin = CommonMsupMixin;\nfunction CommonMsubsupMixin(Base) {\n    return (function (_super) {\n        __extends(class_3, _super);\n        function class_3() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.UVQ = null;\n            return _this;\n        }\n        Object.defineProperty(class_3.prototype, \"subChild\", {\n            get: function () {\n                return this.childNodes[this.node.sub];\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(class_3.prototype, \"supChild\", {\n            get: function () {\n                return this.childNodes[this.node.sup];\n            },\n            enumerable: false,\n            configurable: true\n        });\n        class_3.prototype.computeBBox = function (bbox, recompute) {\n            if (recompute === void 0) { recompute = false; }\n            var basebox = this.baseChild.getBBox();\n            var subbox = this.subChild.getBBox();\n            var supbox = this.supChild.getBBox();\n            bbox.empty();\n            bbox.append(basebox);\n            var w = bbox.w;\n            var _a = __read(this.getUVQ(basebox, subbox, supbox), 2), u = _a[0], v = _a[1];\n            var x = (this.baseCore.bbox.ic ? this.coreIC() * this.coreScale() : 0);\n            bbox.combine(subbox, w, v);\n            bbox.combine(supbox, w + x, u);\n            bbox.w += this.font.params.scriptspace;\n            bbox.clean();\n            this.setChildPWidths(recompute);\n        };\n        class_3.prototype.getUVQ = function (basebox, subbox, supbox) {\n            if (this.UVQ)\n                return this.UVQ;\n            var tex = this.font.params;\n            var t = 3 * tex.rule_thickness;\n            var subscriptshift = this.length2em(this.node.attributes.get('subscriptshift'), tex.sub2);\n            var drop = (this.isCharBase() ? 0 : basebox.d * basebox.rscale + tex.sub_drop * subbox.rscale);\n            var _a = __read([this.getU(basebox, supbox), Math.max(drop, subscriptshift)], 2), u = _a[0], v = _a[1];\n            var q = (u - supbox.d * supbox.rscale) - (subbox.h * subbox.rscale - v);\n            if (q < t) {\n                v += t - q;\n                var p = (4 / 5) * tex.x_height - (u - supbox.d * supbox.rscale);\n                if (p > 0) {\n                    u += p;\n                    v -= p;\n                }\n            }\n            u = Math.max(this.length2em(this.node.attributes.get('superscriptshift'), u), u);\n            v = Math.max(this.length2em(this.node.attributes.get('subscriptshift'), v), v);\n            q = (u - supbox.d * supbox.rscale) - (subbox.h * subbox.rscale - v);\n            this.UVQ = [u, -v, q];\n            return this.UVQ;\n        };\n        return class_3;\n    }(Base));\n}\nexports.CommonMsubsupMixin = CommonMsubsupMixin;\n//# sourceMappingURL=msubsup.js.map"]},"metadata":{},"sourceType":"script"}
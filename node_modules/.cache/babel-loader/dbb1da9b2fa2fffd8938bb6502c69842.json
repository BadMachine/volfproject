{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Bumpy\\\\WebstormProjects\\\\volfproject\\\\src\\\\components\\\\BubbleChart.tsx\";\nimport React, { Component } from 'react';\nimport { Bar } from 'react-chartjs-2';\nimport { chartjsDataTemplate, generateColorsForChart } from '../interfaces/SortInterfaces';\nimport { sortingStore } from './ModalContent';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class BubbleChart extends Component {\n  constructor(props) {\n    super(props);\n    this.chartReference = void 0;\n    this.chart = void 0;\n    this.timer = void 0;\n    this.isSorting = void 0;\n    this.interrupt = void 0;\n    this.uselessRefresh = void 0;\n    this.state = void 0;\n    this.props = void 0;\n    this.timeouts = void 0;\n    this.date = void 0;\n\n    this.equals = (a, b) => JSON.stringify(a) === JSON.stringify(b);\n\n    this.state = chartjsDataTemplate;\n    this.chartReference = /*#__PURE__*/React.createRef();\n    this.timer = 0;\n    this.isSorting = false;\n    this.interrupt = false;\n    this.date = 0;\n    this.uselessRefresh = false;\n    this.timeouts = [];\n  } // randomize(size: number){\n  // \tthis.chart.data.labels = Array.from({length: size}, () => Math.floor(Math.random() * 1000));\n  // \tthis.chart.data.datasets[0].data = Array.from({ length: size }, (_, i) => (i+1).toString());\n  // }\n\n\n  bubbleSort() {\n    const labels = this.chart.data.labels;\n    const data = this.chart.data.datasets[0].data;\n    const colors = this.chart.data.datasets[0].backgroundColor;\n    let swapped;\n    let timeout = 0;\n\n    do {\n      swapped = false;\n\n      for (let i = 0; i < data.length; i++) {\n        if (data[i] > data[i + 1]) {\n          this.swap(labels, i);\n          this.swap(data, i); //this.swap(colors, i);\n\n          this.paintToRed(i);\n          timeout += 100;\n          const theTimeout = this.updateChartDelayed(labels.slice(0), data.slice(0), colors.slice(0), timeout);\n          this.timeouts.push(theTimeout);\n          swapped = true;\n        }\n      }\n    } while (swapped);\n  }\n\n  paintToRed(index) {\n    this.chart.data.datasets[0].backgroundColor[index] = 'rgba(255,0,0,1)';\n  }\n\n  swap(arr, i) {\n    const tmp = arr[i];\n    arr[i] = arr[i + 1];\n    arr[i + 1] = tmp;\n  }\n\n  componentDidMount() {\n    this.chart = this.chartReference.current.chartInstance; // const tempChartJSObject = chartjsDataTemplate;\n    // tempChartJSObject.datasets[0].label = this.props.commands.name;\n    //this.setState(tempChartJSObject);\n  }\n\n  updateChartDelayed(labels, data, colors, timeout) {\n    this.timer = setTimeout(() => {\n      const now = new Date().getTime();\n      const timeDifference = now - this.date;\n      const seconds = Math.floor(timeDifference % (1000 * 60) / 1000);\n      const mils = Math.floor(timeDifference % (1000 * 60) / 1);\n      this.isSorting = true;\n      this.chart.data.datasets[0].label = `${seconds}s ${mils.toString().substr(-3)}ms`;\n      this.chart.data.labels = labels;\n      this.chart.data.datasets[0].data = data;\n      this.chart.data.datasets[0].backgroundColor = colors;\n      this.chart.update();\n      const eth = [...this.chart.data.datasets[0].data].sort((x, y) => x - y);\n\n      if (eth.toString() === this.chart.data.datasets[0].data.toString()) {\n        sortingStore.dispatch({\n          type: ''\n        });\n        this.props.callback();\n      }\n    }, timeout);\n    return this.timer;\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.timer); //this.chart.destroy();\n    //sortingStore.dispatch({type:''});\n  }\n\n  clearAllTimeouts() {\n    for (const timeout in this.timeouts) {\n      clearInterval(this.timeouts[timeout]);\n    }\n\n    this.timeouts = [];\n  }\n\n  refreshChart() {\n    const temporaryDataToSort = chartjsDataTemplate;\n    temporaryDataToSort.datasets[0].data = Array.from({\n      length: this.props.commands.arrayLength\n    }, () => Math.floor(Math.random() * 1000));\n    temporaryDataToSort.labels = Array.from({\n      length: this.props.commands.arrayLength\n    }, (_, i) => (i + 1).toString());\n    [temporaryDataToSort.datasets[0].backgroundColor, temporaryDataToSort.datasets[0].borderColor] = generateColorsForChart(this.props.commands.arrayLength, 0.4);\n    this.setState(temporaryDataToSort);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps !== this.props) {\n      this.date = new Date(Date.now()).getTime();\n      this.clearAllTimeouts();\n\n      if (this.props.commands.StopSort) {\n        console.log('ОТМЕНЯЕМ!!!');\n        this.clearAllTimeouts();\n      } else if (this.props.commands.name !== prevProps.commands.name && this.props.commands.arrayLength !== prevProps.commands.arrayLength) {\n        this.clearAllTimeouts();\n        this.refreshChart();\n        setTimeout(() => {\n          this.bubbleSort();\n        }, 800);\n      } else if (this.props.commands.name !== prevProps.commands.name) {\n        this.bubbleSort();\n      } else if (this.props.commands.arrayLength !== prevProps.commands.arrayLength) {\n        this.refreshChart();\n        this.clearAllTimeouts();\n        setTimeout(() => {\n          this.bubbleSort();\n        }, 800);\n      } else if (this.props.commands.arrayLength === prevProps.commands.arrayLength) {\n        this.refreshChart();\n        this.clearAllTimeouts();\n        setTimeout(() => {\n          this.bubbleSort();\n        }, 800);\n      }\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Bar, {\n        data: this.state,\n        width: 100,\n        height: 50,\n        options: {\n          legend: {\n            display: true,\n            position: 'top',\n            labels: {\n              boxWidth: 0\n            }\n          }\n        },\n        ref: this.chartReference\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 9\n      }, this), \" \"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 4\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/Bumpy/WebstormProjects/volfproject/src/components/BubbleChart.tsx"],"names":["React","Component","Bar","chartjsDataTemplate","generateColorsForChart","sortingStore","BubbleChart","constructor","props","chartReference","chart","timer","isSorting","interrupt","uselessRefresh","state","timeouts","date","equals","a","b","JSON","stringify","createRef","bubbleSort","labels","data","datasets","colors","backgroundColor","swapped","timeout","i","length","swap","paintToRed","theTimeout","updateChartDelayed","slice","push","index","arr","tmp","componentDidMount","current","chartInstance","setTimeout","now","Date","getTime","timeDifference","seconds","Math","floor","mils","label","toString","substr","update","eth","sort","x","y","dispatch","type","callback","componentWillUnmount","clearInterval","clearAllTimeouts","refreshChart","temporaryDataToSort","Array","from","commands","arrayLength","random","_","borderColor","setState","componentDidUpdate","prevProps","StopSort","console","log","name","render","legend","display","position","boxWidth"],"mappings":"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","sourcesContent":["import React, {Component, useState} from 'react';\r\nimport {Bar} from 'react-chartjs-2';\r\nimport {BubbleCommandsInterface, chartjsDataType, chartjsDataTemplate, initialBubbleCommandsState, generateColorsForChart} from '../interfaces/SortInterfaces';\r\nimport {sortingStore} from './ModalContent';\r\n\r\n\r\ntype callback=()=>void;\r\n\r\nexport default class BubbleChart extends Component<BubbleCommandsInterface>{\r\n\tprivate chartReference: React.RefObject<any>;\r\n\tprivate chart: any;\r\n\tprivate timer: any;\r\n\tprivate isSorting: boolean;\r\n\tprivate interrupt: boolean;\r\n\tprivate uselessRefresh: boolean;\r\n\tpublic state;\r\n\tpublic props: any;\r\n\tprivate timeouts:number[];\r\n\tprivate date: number;\r\n\r\n\tconstructor(props: BubbleCommandsInterface) {\r\n\t\tsuper(props);\r\n\t\tthis.state = chartjsDataTemplate;\r\n\r\n\t\tthis.chartReference = React.createRef<any>();\r\n\r\n\t\tthis.timer = 0;\r\n\r\n\t\tthis.isSorting = false;\r\n\r\n\t\tthis.interrupt = false;\r\n\r\n\t\tthis.date =0;\r\n\r\n\r\n\t\tthis.uselessRefresh = false;\r\n\t\tthis.timeouts = [];\r\n\r\n\t}\r\n\r\n\t// randomize(size: number){\r\n\t// \tthis.chart.data.labels = Array.from({length: size}, () => Math.floor(Math.random() * 1000));\r\n\t// \tthis.chart.data.datasets[0].data = Array.from({ length: size }, (_, i) => (i+1).toString());\r\n\t// }\r\n\r\n\tbubbleSort() {\r\n\t\tconst labels = this.chart.data.labels;\r\n\t\tconst data = this.chart.data.datasets[0].data;\r\n\t\tconst colors = this.chart.data.datasets[0].backgroundColor;\r\n\t\tlet swapped;\r\n\t\tlet timeout = 0;\r\n\r\n\t\tdo {\r\n\t\t\tswapped = false;\r\n\t\t\tfor (let i = 0; i < data.length; i++) {\r\n\t\t\t\tif (data[i] > data[i + 1]) {\r\n\t\t\t\t\tthis.swap(labels, i);\r\n\t\t\t\t\tthis.swap(data, i);\r\n\t\t\t\t\t//this.swap(colors, i);\r\n\t\t\t\t\tthis.paintToRed(i);\r\n\t\t\t\t\ttimeout += 100;\r\n\t\t\t\t\tconst theTimeout = this.updateChartDelayed(labels.slice(0), data.slice(0), colors.slice(0), timeout);\r\n\t\t\t\t\tthis.timeouts.push(theTimeout);\r\n\t\t\t\t\tswapped = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} while (swapped);\r\n\r\n\t}\r\n\r\n\tpaintToRed(index:number){\r\n\t\tthis.chart.data.datasets[0].backgroundColor[index] = 'rgba(255,0,0,1)';\r\n\t}\r\n\r\n\tswap(arr:any, i:any) {\r\n\t\tconst tmp = arr[i];\r\n\t\tarr[i] = arr[i + 1];\r\n\t\tarr[i + 1] = tmp;\r\n\t}\r\n\r\n\tequals = (a:number[], b:number[]) => JSON.stringify(a) === JSON.stringify(b);\r\n\r\n\tcomponentDidMount(){\r\n\r\n\t\tthis.chart = this.chartReference.current.chartInstance;\r\n\t\t// const tempChartJSObject = chartjsDataTemplate;\r\n\t\t// tempChartJSObject.datasets[0].label = this.props.commands.name;\r\n\t\t//this.setState(tempChartJSObject);\r\n\t}\r\n\r\n\r\n\tupdateChartDelayed(labels: string[], data:number[], colors:string[], timeout:number) {\r\n\r\n\r\n\r\n\t\tthis.timer = setTimeout(() => {\r\n\r\n\t\t\tconst now = new Date().getTime();\r\n\r\n\t\t\tconst timeDifference  = now - this.date;\r\n\t\t\tconst seconds = Math.floor((timeDifference % (1000 * 60)) / 1000);\r\n\t\t\tconst mils = Math.floor((timeDifference % (1000 * 60)) / 1);\r\n\r\n\t\t\tthis.isSorting = true;\r\n\t\t\tthis.chart.data.datasets[0].label =  `${seconds}s ${mils.toString().substr(-3)}ms`  ;\r\n\t\t\tthis.chart.data.labels = labels;\r\n\t\t\tthis.chart.data.datasets[0].data = data;\r\n\t\t\tthis.chart.data.datasets[0].backgroundColor = colors;\r\n\t\t\tthis.chart.update();\r\n\r\n\t\t\tconst eth = [...this.chart.data.datasets[0].data].sort((x,y)=> x-y);\r\n\t\t\tif( eth.toString() === this.chart.data.datasets[0].data.toString()) {\r\n\t\t\t\tsortingStore.dispatch({type:''});\r\n\t\t\t\tthis.props.callback();\r\n\t\t\t}\r\n\r\n\r\n\t\t}, timeout);\r\n\r\n\r\n\r\n\t\treturn this.timer;\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tclearInterval(this.timer);\r\n\t\t//this.chart.destroy();\r\n\t\t//sortingStore.dispatch({type:''});\r\n\t}\r\n\r\n\r\n\tclearAllTimeouts(){\r\n\t\tfor(const timeout in this.timeouts){\r\n\t\t\tclearInterval(this.timeouts[timeout]);\r\n\t\t}\r\n\t\tthis.timeouts=[];\r\n\t}\r\n\r\n\trefreshChart(){\r\n\t\tconst temporaryDataToSort = chartjsDataTemplate;\r\n\t\ttemporaryDataToSort.datasets[0].data = Array.from({length: this.props.commands.arrayLength}, () => Math.floor(Math.random() * 1000));\r\n\t\ttemporaryDataToSort.labels = Array.from({ length: this.props.commands.arrayLength }, (_, i) => (i+1).toString());\r\n\t\t[temporaryDataToSort.datasets[0].backgroundColor, temporaryDataToSort.datasets[0].borderColor] = generateColorsForChart(this.props.commands.arrayLength, 0.4);\r\n\t\tthis.setState(temporaryDataToSort);\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps:BubbleCommandsInterface) {\r\n\r\n\t\tif(prevProps!==this.props){\r\n\r\n\t\t\tthis.date = new Date(Date.now()).getTime();\r\n\r\n\t\t\tthis.clearAllTimeouts();\r\n\r\n\t\t\tif(this.props.commands.StopSort) {\r\n\t\t\t\tconsole.log('ОТМЕНЯЕМ!!!');\r\n\t\t\t\tthis.clearAllTimeouts();\r\n\r\n\t\t\t}else if(this.props.commands.name !== prevProps.commands.name && this.props.commands.arrayLength!==prevProps.commands.arrayLength){\r\n\r\n\t\t\t\tthis.clearAllTimeouts();\r\n\t\t\t\tthis.refreshChart();\r\n\t\t\t\tsetTimeout(()=>{this.bubbleSort();}, 800);\r\n\t\t\t}else if(this.props.commands.name !== prevProps.commands.name){\r\n\r\n\t\t\t\tthis.bubbleSort();\r\n\t\t\t}else if (this.props.commands.arrayLength!==prevProps.commands.arrayLength){\r\n\r\n\t\t\t\tthis.refreshChart();\r\n\t\t\t\tthis.clearAllTimeouts();\r\n\t\t\t\tsetTimeout(()=>{this.bubbleSort();}, 800);\r\n\r\n\t\t\t}else if(this.props.commands.arrayLength===prevProps.commands.arrayLength ){\r\n\r\n\t\t\t\tthis.refreshChart();\r\n\t\t\t\tthis.clearAllTimeouts();\r\n\t\t\t\tsetTimeout(()=>{this.bubbleSort();}, 800);\r\n\t\t\t}\r\n\r\n\r\n\r\n\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\r\n\r\n\trender(){\r\n\t\treturn(\r\n\t\t\t<div><Bar data={this.state} width={100} height={50} options={{\r\n\t\t\t\tlegend: {\r\n\t\t\t\t\tdisplay: true,\r\n\t\t\t\t\tposition: 'top',\r\n\t\t\t\t\tlabels: {\r\n\t\t\t\t\t\tboxWidth: 0,\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t}} ref={this.chartReference}/> </div>\r\n\t\t);\r\n\r\n\t}\r\n\r\n\r\n}\r\n"]},"metadata":{},"sourceType":"module"}
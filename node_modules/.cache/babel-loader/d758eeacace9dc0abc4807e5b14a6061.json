{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SVGmo = void 0;\n\nvar Wrapper_js_1 = require(\"../Wrapper.js\");\n\nvar mo_js_1 = require(\"../../common/Wrappers/mo.js\");\n\nvar mo_js_2 = require(\"../../../core/MmlTree/MmlNodes/mo.js\");\n\nvar BBox_js_1 = require(\"../../../util/BBox.js\");\n\nvar VFUZZ = 0.1;\nvar HFUZZ = 0.1;\n\nvar SVGmo = function (_super) {\n  __extends(SVGmo, _super);\n\n  function SVGmo() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  SVGmo.prototype.toSVG = function (parent) {\n    var attributes = this.node.attributes;\n    var symmetric = attributes.get('symmetric') && this.stretch.dir !== 2;\n    var stretchy = this.stretch.dir !== 0;\n\n    if (stretchy && this.size === null) {\n      this.getStretchedVariant([]);\n    }\n\n    var svg = this.standardSVGnode(parent);\n\n    if (stretchy && this.size < 0) {\n      this.stretchSVG();\n    } else {\n      if (symmetric || attributes.get('largeop')) {\n        var bbox = BBox_js_1.BBox.empty();\n\n        _super.prototype.computeBBox.call(this, bbox);\n\n        var u = this.fixed((bbox.d - bbox.h) / 2 + this.font.params.axis_height);\n\n        if (u !== '0') {\n          this.adaptor.setAttribute(svg, 'transform', 'translate(0 ' + u + ')');\n        }\n      }\n\n      this.addChildren(svg);\n    }\n  };\n\n  SVGmo.prototype.stretchSVG = function () {\n    var stretch = this.stretch.stretch;\n    var bbox = this.getBBox();\n\n    if (this.stretch.dir === 1) {\n      this.stretchVertical(stretch, bbox);\n    } else {\n      this.stretchHorizontal(stretch, bbox);\n    }\n  };\n\n  SVGmo.prototype.stretchVertical = function (stretch, bbox) {\n    var h = bbox.h,\n        d = bbox.d,\n        w = bbox.w;\n    var T = this.addTop(stretch[0], h, w);\n    var B = this.addBot(stretch[2], d, w);\n\n    if (stretch.length === 4) {\n      var _a = __read(this.addMidV(stretch[3], w), 2),\n          H = _a[0],\n          D = _a[1];\n\n      this.addExtV(stretch[1], h, 0, T, H, w);\n      this.addExtV(stretch[1], 0, d, D, B, w);\n    } else {\n      this.addExtV(stretch[1], h, d, T, B, w);\n    }\n  };\n\n  SVGmo.prototype.stretchHorizontal = function (stretch, bbox) {\n    var w = bbox.w;\n    var L = this.addLeft(stretch[0]);\n    var R = this.addRight(stretch[2], w);\n\n    if (stretch.length === 4) {\n      var _a = __read(this.addMidH(stretch[3], w), 2),\n          x1 = _a[0],\n          x2 = _a[1];\n\n      var w2 = w / 2;\n      this.addExtH(stretch[1], w2, L, w2 - x1);\n      this.addExtH(stretch[1], w2, x2 - w2, R, w2);\n    } else {\n      this.addExtH(stretch[1], w, L, R);\n    }\n  };\n\n  SVGmo.prototype.getChar = function (n) {\n    var char = this.font.getChar('-size4', n) || [0, 0, 0, null];\n    return [char[0], char[1], char[2], char[3] || {}];\n  };\n\n  SVGmo.prototype.addGlyph = function (n, x, y, parent) {\n    if (parent === void 0) {\n      parent = null;\n    }\n\n    return this.placeChar(n, x, y, parent || this.element, '-size4');\n  };\n\n  SVGmo.prototype.addTop = function (n, H, W) {\n    if (!n) return 0;\n\n    var _a = __read(this.getChar(n), 3),\n        h = _a[0],\n        d = _a[1],\n        w = _a[2];\n\n    this.addGlyph(n, (W - w) / 2, H - h);\n    return h + d;\n  };\n\n  SVGmo.prototype.addExtV = function (n, H, D, T, B, W) {\n    var _this = this;\n\n    if (!n) return;\n    T = Math.max(0, T - VFUZZ);\n    B = Math.max(0, B - VFUZZ);\n    var adaptor = this.adaptor;\n\n    var _a = __read(this.getChar(n), 3),\n        h = _a[0],\n        d = _a[1],\n        w = _a[2];\n\n    var Y = H + D - T - B;\n    var s = 1.5 * Y / (h + d);\n    var y = (s * (h - d) - Y) / 2;\n    if (Y <= 0) return;\n    var svg = this.svg('svg', {\n      width: this.fixed(w),\n      height: this.fixed(Y),\n      y: this.fixed(B - D),\n      x: this.fixed((W - w) / 2),\n      viewBox: [0, y, w, Y].map(function (x) {\n        return _this.fixed(x);\n      }).join(' ')\n    });\n    this.addGlyph(n, 0, 0, svg);\n    var glyph = adaptor.lastChild(svg);\n    adaptor.setAttribute(glyph, 'transform', 'scale(1, ' + this.jax.fixed(s) + ')');\n    adaptor.append(this.element, svg);\n  };\n\n  SVGmo.prototype.addBot = function (n, D, W) {\n    if (!n) return 0;\n\n    var _a = __read(this.getChar(n), 3),\n        h = _a[0],\n        d = _a[1],\n        w = _a[2];\n\n    this.addGlyph(n, (W - w) / 2, d - D);\n    return h + d;\n  };\n\n  SVGmo.prototype.addMidV = function (n, W) {\n    if (!n) return [0, 0];\n\n    var _a = __read(this.getChar(n), 3),\n        h = _a[0],\n        d = _a[1],\n        w = _a[2];\n\n    var y = (d - h) / 2 + this.font.params.axis_height;\n    this.addGlyph(n, (W - w) / 2, y);\n    return [h + y, d - y];\n  };\n\n  SVGmo.prototype.addLeft = function (n) {\n    return n ? this.addGlyph(n, 0, 0) : 0;\n  };\n\n  SVGmo.prototype.addExtH = function (n, W, L, R, x) {\n    var _this = this;\n\n    if (x === void 0) {\n      x = 0;\n    }\n\n    if (!n) return;\n    R = Math.max(0, R - HFUZZ);\n    L = Math.max(0, L - HFUZZ);\n\n    var _a = __read(this.getChar(n), 3),\n        h = _a[0],\n        d = _a[1],\n        w = _a[2];\n\n    var X = W - L - R;\n    var Y = h + d + 2 * VFUZZ;\n    var s = 1.5 * (X / w);\n    var D = -(d + VFUZZ);\n    if (X <= 0) return;\n    var svg = this.svg('svg', {\n      width: this.fixed(X),\n      height: this.fixed(Y),\n      x: this.fixed(x + L),\n      y: this.fixed(D),\n      viewBox: [(s * w - X) / 2, D, X, Y].map(function (x) {\n        return _this.fixed(x);\n      }).join(' ')\n    });\n    this.addGlyph(n, 0, 0, svg);\n    var glyph = this.adaptor.lastChild(svg);\n    this.adaptor.setAttribute(glyph, 'transform', 'scale(' + this.jax.fixed(s) + ', 1)');\n    this.adaptor.append(this.element, svg);\n  };\n\n  SVGmo.prototype.addRight = function (n, W) {\n    if (!n) return 0;\n    var w = this.getChar(n)[2];\n    return this.addGlyph(n, W - w, 0);\n  };\n\n  SVGmo.prototype.addMidH = function (n, W) {\n    if (!n) return [0, 0];\n    var w = this.getChar(n)[2];\n    this.addGlyph(n, (W - w) / 2, 0);\n    return [(W - w) / 2, (W + w) / 2];\n  };\n\n  SVGmo.kind = mo_js_2.MmlMo.prototype.kind;\n  return SVGmo;\n}(mo_js_1.CommonMoMixin(Wrapper_js_1.SVGWrapper));\n\nexports.SVGmo = SVGmo;","map":{"version":3,"sources":["../../../../ts/output/svg/Wrappers/mo.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SVGmo = void 0;\nvar Wrapper_js_1 = require(\"../Wrapper.js\");\nvar mo_js_1 = require(\"../../common/Wrappers/mo.js\");\nvar mo_js_2 = require(\"../../../core/MmlTree/MmlNodes/mo.js\");\nvar BBox_js_1 = require(\"../../../util/BBox.js\");\nvar VFUZZ = 0.1;\nvar HFUZZ = 0.1;\nvar SVGmo = (function (_super) {\n    __extends(SVGmo, _super);\n    function SVGmo() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SVGmo.prototype.toSVG = function (parent) {\n        var attributes = this.node.attributes;\n        var symmetric = attributes.get('symmetric') && this.stretch.dir !== 2;\n        var stretchy = this.stretch.dir !== 0;\n        if (stretchy && this.size === null) {\n            this.getStretchedVariant([]);\n        }\n        var svg = this.standardSVGnode(parent);\n        if (stretchy && this.size < 0) {\n            this.stretchSVG();\n        }\n        else {\n            if (symmetric || attributes.get('largeop')) {\n                var bbox = BBox_js_1.BBox.empty();\n                _super.prototype.computeBBox.call(this, bbox);\n                var u = this.fixed((bbox.d - bbox.h) / 2 + this.font.params.axis_height);\n                if (u !== '0') {\n                    this.adaptor.setAttribute(svg, 'transform', 'translate(0 ' + u + ')');\n                }\n            }\n            this.addChildren(svg);\n        }\n    };\n    SVGmo.prototype.stretchSVG = function () {\n        var stretch = this.stretch.stretch;\n        var bbox = this.getBBox();\n        if (this.stretch.dir === 1) {\n            this.stretchVertical(stretch, bbox);\n        }\n        else {\n            this.stretchHorizontal(stretch, bbox);\n        }\n    };\n    SVGmo.prototype.stretchVertical = function (stretch, bbox) {\n        var h = bbox.h, d = bbox.d, w = bbox.w;\n        var T = this.addTop(stretch[0], h, w);\n        var B = this.addBot(stretch[2], d, w);\n        if (stretch.length === 4) {\n            var _a = __read(this.addMidV(stretch[3], w), 2), H = _a[0], D = _a[1];\n            this.addExtV(stretch[1], h, 0, T, H, w);\n            this.addExtV(stretch[1], 0, d, D, B, w);\n        }\n        else {\n            this.addExtV(stretch[1], h, d, T, B, w);\n        }\n    };\n    SVGmo.prototype.stretchHorizontal = function (stretch, bbox) {\n        var w = bbox.w;\n        var L = this.addLeft(stretch[0]);\n        var R = this.addRight(stretch[2], w);\n        if (stretch.length === 4) {\n            var _a = __read(this.addMidH(stretch[3], w), 2), x1 = _a[0], x2 = _a[1];\n            var w2 = w / 2;\n            this.addExtH(stretch[1], w2, L, w2 - x1);\n            this.addExtH(stretch[1], w2, x2 - w2, R, w2);\n        }\n        else {\n            this.addExtH(stretch[1], w, L, R);\n        }\n    };\n    SVGmo.prototype.getChar = function (n) {\n        var char = this.font.getChar('-size4', n) || [0, 0, 0, null];\n        return [char[0], char[1], char[2], char[3] || {}];\n    };\n    SVGmo.prototype.addGlyph = function (n, x, y, parent) {\n        if (parent === void 0) { parent = null; }\n        return this.placeChar(n, x, y, parent || this.element, '-size4');\n    };\n    SVGmo.prototype.addTop = function (n, H, W) {\n        if (!n)\n            return 0;\n        var _a = __read(this.getChar(n), 3), h = _a[0], d = _a[1], w = _a[2];\n        this.addGlyph(n, (W - w) / 2, H - h);\n        return h + d;\n    };\n    SVGmo.prototype.addExtV = function (n, H, D, T, B, W) {\n        var _this = this;\n        if (!n)\n            return;\n        T = Math.max(0, T - VFUZZ);\n        B = Math.max(0, B - VFUZZ);\n        var adaptor = this.adaptor;\n        var _a = __read(this.getChar(n), 3), h = _a[0], d = _a[1], w = _a[2];\n        var Y = H + D - T - B;\n        var s = 1.5 * Y / (h + d);\n        var y = (s * (h - d) - Y) / 2;\n        if (Y <= 0)\n            return;\n        var svg = this.svg('svg', {\n            width: this.fixed(w), height: this.fixed(Y),\n            y: this.fixed(B - D), x: this.fixed((W - w) / 2),\n            viewBox: [0, y, w, Y].map(function (x) { return _this.fixed(x); }).join(' ')\n        });\n        this.addGlyph(n, 0, 0, svg);\n        var glyph = adaptor.lastChild(svg);\n        adaptor.setAttribute(glyph, 'transform', 'scale(1, ' + this.jax.fixed(s) + ')');\n        adaptor.append(this.element, svg);\n    };\n    SVGmo.prototype.addBot = function (n, D, W) {\n        if (!n)\n            return 0;\n        var _a = __read(this.getChar(n), 3), h = _a[0], d = _a[1], w = _a[2];\n        this.addGlyph(n, (W - w) / 2, d - D);\n        return h + d;\n    };\n    SVGmo.prototype.addMidV = function (n, W) {\n        if (!n)\n            return [0, 0];\n        var _a = __read(this.getChar(n), 3), h = _a[0], d = _a[1], w = _a[2];\n        var y = (d - h) / 2 + this.font.params.axis_height;\n        this.addGlyph(n, (W - w) / 2, y);\n        return [h + y, d - y];\n    };\n    SVGmo.prototype.addLeft = function (n) {\n        return (n ? this.addGlyph(n, 0, 0) : 0);\n    };\n    SVGmo.prototype.addExtH = function (n, W, L, R, x) {\n        var _this = this;\n        if (x === void 0) { x = 0; }\n        if (!n)\n            return;\n        R = Math.max(0, R - HFUZZ);\n        L = Math.max(0, L - HFUZZ);\n        var _a = __read(this.getChar(n), 3), h = _a[0], d = _a[1], w = _a[2];\n        var X = W - L - R;\n        var Y = h + d + 2 * VFUZZ;\n        var s = 1.5 * (X / w);\n        var D = -(d + VFUZZ);\n        if (X <= 0)\n            return;\n        var svg = this.svg('svg', {\n            width: this.fixed(X), height: this.fixed(Y),\n            x: this.fixed(x + L), y: this.fixed(D),\n            viewBox: [(s * w - X) / 2, D, X, Y].map(function (x) { return _this.fixed(x); }).join(' ')\n        });\n        this.addGlyph(n, 0, 0, svg);\n        var glyph = this.adaptor.lastChild(svg);\n        this.adaptor.setAttribute(glyph, 'transform', 'scale(' + this.jax.fixed(s) + ', 1)');\n        this.adaptor.append(this.element, svg);\n    };\n    SVGmo.prototype.addRight = function (n, W) {\n        if (!n)\n            return 0;\n        var w = this.getChar(n)[2];\n        return this.addGlyph(n, W - w, 0);\n    };\n    SVGmo.prototype.addMidH = function (n, W) {\n        if (!n)\n            return [0, 0];\n        var w = this.getChar(n)[2];\n        this.addGlyph(n, (W - w) / 2, 0);\n        return [(W - w) / 2, (W + w) / 2];\n    };\n    SVGmo.kind = mo_js_2.MmlMo.prototype.kind;\n    return SVGmo;\n}(mo_js_1.CommonMoMixin(Wrapper_js_1.SVGWrapper)));\nexports.SVGmo = SVGmo;\n//# sourceMappingURL=mo.js.map"]},"metadata":{},"sourceType":"script"}
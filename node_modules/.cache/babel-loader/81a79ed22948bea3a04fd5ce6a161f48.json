{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Bumpy\\\\WebstormProjects\\\\volfproject\\\\src\\\\components\\\\drawCOCOimage.tsx\";\nimport React from 'react'; //import * as React from 'react';\n\nimport { randomColor } from '../interfaces/SortInterfaces';\nimport { OverlayTrigger, Tooltip, Row } from 'react-bootstrap';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport class DrawCOCOimage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.canvas = void 0;\n    this.canvasForeground = void 0;\n    this.imageHasBeenLoaded = void 0;\n    this.tooltipRef = void 0;\n    this.data = void 0;\n    this.hColors = void 0;\n    this.hColors = Array.from({\n      length: 150\n    }, () => `rgba(${randomColor()}, ${randomColor()}, ${randomColor()}, 0.4`);\n    this.tooltipRef = /*#__PURE__*/React.createRef();\n    this.imageHasBeenLoaded = false;\n    this.data = {\n      bboxes: [],\n      segments: [],\n      descriptions: []\n    };\n  }\n\n  componentDidMount() {\n    this.updateImage();\n  }\n\n  handleMouse(e) {\n    const ctx = this.canvasForeground.getContext('2d');\n    const rect = this.canvasForeground.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n    let box;\n    ctx.clearRect(0, 0, this.canvasForeground.width, this.canvasForeground.height);\n    let i = 0;\n\n    if (this.props.props.Image.showBboxes && this.props.props.Image.showKeypoints && this.imageHasBeenLoaded) {\n      let segment;\n\n      while (i < this.data.bboxes.length) {\n        ctx.beginPath();\n        box = this.data.bboxes[i];\n        segment = this.data.segments[i];\n        ctx.rect(box[0], box[1], box[2], box[3]);\n        const RGBA = this.hColors[i].substr(0, this.hColors[i].length - 4) + ' 0.2)';\n\n        if (ctx.isPointInPath(x, y)) {\n          ctx.fillStyle = RGBA;\n          this.tooltipRef.current.innerText = this.data.descriptions[i];\n        } else {\n          ctx.fillStyle = this.hColors[i];\n        }\n\n        ctx.fill();\n        ctx.closePath();\n        ctx.beginPath();\n\n        for (let z = 0; z < segment.length; z++) {\n          ctx.moveTo(segment[z][0], segment[z][1]);\n\n          for (let y = 0; y < segment[z].length; y += 2) {\n            ctx.lineTo(segment[z][y], segment[z][y + 1]);\n          }\n\n          ctx.lineTo(segment[z][0], segment[z][1]);\n          ctx.lineWidth = 8;\n          ctx.stroke();\n        }\n\n        ctx.fill();\n        ctx.closePath();\n        i++;\n      }\n    } else if (this.props.props.Image.showBboxes && this.imageHasBeenLoaded) {\n      while (i < this.data.bboxes.length) {\n        ctx.beginPath();\n        box = this.data.bboxes[i];\n        ctx.rect(box[0], box[1], box[2], box[3]);\n        const RGBA = this.hColors[i].substr(0, this.hColors[i].length - 4) + ' 0.2)';\n\n        if (ctx.isPointInPath(x, y)) {\n          ctx.fillStyle = RGBA;\n          this.tooltipRef.current.innerText = this.data.descriptions[i];\n        } else {\n          ctx.fillStyle = this.hColors[i];\n        }\n\n        ctx.fill();\n        ctx.closePath();\n        i++;\n      }\n    } else if (this.props.props.Image.showKeypoints && this.imageHasBeenLoaded) {\n      let segment;\n      let i = 0;\n\n      while (i < this.data.segments.length) {\n        ctx.beginPath();\n        const RGBA = this.hColors[i].substr(0, this.hColors[i].length - 4) + ' 0.2)';\n        segment = this.data.segments[i];\n\n        for (let z = 0; z < segment.length; z++) {\n          ctx.moveTo(segment[z][0], segment[z][1]);\n\n          for (let y = 0; y < segment[z].length; y += 2) {\n            ctx.lineTo(segment[z][y], segment[z][y + 1]);\n          }\n\n          ctx.lineTo(segment[z][0], segment[z][1]);\n          ctx.lineWidth = 8;\n          ctx.stroke();\n        }\n\n        if (ctx.isPointInPath(x, y)) {\n          ctx.fillStyle = RGBA;\n          this.tooltipRef.current.innerText = this.data.descriptions[i];\n        } else {\n          ctx.fillStyle = this.hColors[i];\n        }\n\n        ctx.stroke();\n        ctx.fill();\n        ctx.closePath();\n        i++;\n      }\n    }\n  }\n\n  updateImage() {\n    this.imageHasBeenLoaded = false;\n    const bboxes = [];\n    const descriptions = [];\n    const imageObj1 = new Image();\n    imageObj1.src = this.props.props.Image.url;\n\n    imageObj1.onload = () => {\n      const ctx = this.canvas.getContext('2d');\n      const ctxForeground = this.canvasForeground.getContext('2d');\n      ctx.drawImage(imageObj1, 0, 0);\n\n      if (this.props.props.Image.showBboxes && this.props.props.Image.showKeypoints) {\n        const segments = [];\n        ctxForeground.clearRect(0, 0, this.props.props.Image.width, this.props.props.Image.height);\n        this.props.props.Image.info.bboxes.forEach((bbox, index) => {\n          const fillColor = this.hColors[index];\n          bboxes.push(bbox.box);\n          descriptions.push(bbox.category);\n          ctxForeground.fillStyle = fillColor;\n          ctxForeground.fillRect(bbox.box[0], bbox.box[1], bbox.box[2], bbox.box[3]);\n        });\n        this.props.props.Image.info.segments.forEach((segment, index) => {\n          const segmentData = segment.segments;\n          const subSegmenedToSegment = [];\n\n          for (let z = 0; z < segmentData.length; z++) {\n            subSegmenedToSegment.push(segmentData[z]);\n\n            if (descriptions.length === 0) {\n              descriptions.push(segment.category);\n            }\n\n            ctxForeground.beginPath();\n            ctxForeground.moveTo(segmentData[z][0], segmentData[z][1]);\n\n            for (let i = 2; i < segmentData[z].length; i += 2) {\n              ctxForeground.lineTo(segmentData[z][i], segmentData[z][i + 1]);\n            }\n\n            ctxForeground.lineTo(segmentData[z][0], segmentData[z][1]);\n            ctxForeground.lineWidth = 8;\n            ctxForeground.stroke();\n            ctxForeground.fillStyle = this.hColors[index];\n            ctxForeground.fill();\n            ctxForeground.beginPath();\n          }\n\n          segments.push(subSegmenedToSegment);\n        });\n        this.data = {\n          bboxes: bboxes,\n          segments: segments,\n          descriptions: descriptions\n        };\n      } else if (this.props.props.Image.showBboxes) {\n        ctxForeground.clearRect(0, 0, this.props.props.Image.width, this.props.props.Image.height);\n        this.props.props.Image.info.bboxes.forEach((bbox, index) => {\n          const fillColor = this.hColors[index];\n          bboxes.push(bbox.box);\n          descriptions.push(bbox.category);\n          ctxForeground.fillStyle = fillColor;\n          ctxForeground.fillRect(bbox.box[0], bbox.box[1], bbox.box[2], bbox.box[3]);\n        });\n        this.data = {\n          bboxes: bboxes,\n          segments: this.data.segments,\n          descriptions: descriptions\n        };\n      } else if (this.props.props.Image.showKeypoints) {\n        const segments = [];\n        ctxForeground.clearRect(0, 0, this.props.props.Image.width, this.props.props.Image.height);\n        this.props.props.Image.info.segments.forEach((segment, index) => {\n          descriptions.push(this.props.props.Image.info.segments[index].category);\n          const segmentData = segment.segments;\n          const subSegmenedToSegment = [];\n\n          for (let z = 0; z < segmentData.length; z++) {\n            subSegmenedToSegment.push(segmentData[z]);\n            ctxForeground.beginPath();\n            ctxForeground.moveTo(segmentData[z][0], segmentData[z][1]);\n\n            for (let i = 0; i < segmentData[z].length; i += 2) {\n              ctxForeground.lineTo(segmentData[z][i], segmentData[z][i + 1]);\n            }\n\n            ctxForeground.lineTo(segmentData[z][0], segmentData[z][1]);\n            ctxForeground.lineWidth = 8;\n            ctxForeground.stroke();\n            ctxForeground.fillStyle = this.hColors[index];\n            ctxForeground.fill();\n            ctxForeground.closePath();\n          }\n\n          segments.push(subSegmenedToSegment);\n        });\n        this.data = {\n          bboxes: this.data.bboxes,\n          segments: segments,\n          descriptions: descriptions\n        };\n      } else {\n        ctxForeground.clearRect(0, 0, this.props.props.Image.width, this.props.props.Image.height);\n      }\n\n      this.imageHasBeenLoaded = true;\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.props.Image.showBboxes === true) {\n      this.updateImage();\n    } else {\n      this.updateImage();\n    }\n\n    if (this.props.props.Image.showKeypoints === true) {\n      this.updateImage();\n    } else {\n      this.updateImage();\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(Row, {\n      style: {\n        width: `${this.props.props.Image.width}px`\n      },\n      children: /*#__PURE__*/_jsxDEV(OverlayTrigger, {\n        placement: 'bottom',\n        overlay: /*#__PURE__*/_jsxDEV(Tooltip, {\n          id: \"tooltip-disabled\",\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            ref: this.tooltipRef,\n            children: \" \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 83\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 52\n        }, this),\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: 'canvasStack',\n          style: {\n            display: 'flex'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n            style: {\n              zIndex: 1,\n              objectFit: 'contain',\n              width: '100%'\n            },\n            ref: canvas => this.canvas = canvas,\n            width: this.props.props.Image.width,\n            height: this.props.props.Image.height,\n            children: \" \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n            style: {\n              top: 0,\n              objectFit: 'contain',\n              width: '100%',\n              zIndex: 2\n            },\n            onMouseMove: this.handleMouse.bind(this),\n            ref: canvas => this.canvasForeground = canvas,\n            width: this.props.props.Image.width,\n            height: this.props.props.Image.height\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 4\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/Bumpy/WebstormProjects/volfproject/src/components/drawCOCOimage.tsx"],"names":["React","randomColor","OverlayTrigger","Tooltip","Row","DrawCOCOimage","Component","constructor","props","canvas","canvasForeground","imageHasBeenLoaded","tooltipRef","data","hColors","Array","from","length","createRef","bboxes","segments","descriptions","componentDidMount","updateImage","handleMouse","e","ctx","getContext","rect","getBoundingClientRect","x","clientX","left","y","clientY","top","box","clearRect","width","height","i","Image","showBboxes","showKeypoints","segment","beginPath","RGBA","substr","isPointInPath","fillStyle","current","innerText","fill","closePath","z","moveTo","lineTo","lineWidth","stroke","imageObj1","src","url","onload","ctxForeground","drawImage","info","forEach","bbox","index","fillColor","push","category","fillRect","segmentData","subSegmenedToSegment","componentDidUpdate","prevProps","render","display","zIndex","objectFit","bind"],"mappings":"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","sourcesContent":["import React from 'react';\r\n//import * as React from 'react';\r\nimport {CommandsInterface, randomColor} from '../interfaces/SortInterfaces';\r\nimport {OverlayTrigger, Tooltip, Row} from 'react-bootstrap';\r\nimport {ReactDOM} from 'react';\r\n\r\ninterface bbox{\r\n\tbox: number[],\r\n\tcategory:string\r\n}\r\ninterface segment{\r\n\tsegments: number[]\r\n}\r\n\r\ninterface segments{\r\n\tarea: number,\r\n\tsegments: number[][],\r\n\tcategory:string\r\n}\r\n\r\n\r\ninterface props{\r\n\tprops: {\r\n\t\tImage:{\r\n\t\tfilename: string,\r\n\t\turl: string,\r\n\t\theight: number,\r\n\t\twidth: number,\r\n\t\tinfo: {\r\n\t\t\tbboxes: bbox[],\r\n\t\t\tsegments: any\r\n\t\t},\r\n\t\tshowBboxes: boolean,\r\n\t\tshowKeypoints: boolean\r\n\t}\r\n\t}\r\n}\r\ninterface stateInterface{\r\n\tbboxes:number[][],\r\n\tsegments: number[][][],\r\n\tdescriptions:string[]\r\n}\r\n\r\nexport class DrawCOCOimage extends React.Component<props, any>{\r\n\tpublic canvas:any;\r\n\tpublic canvasForeground:any;\r\n\tprivate imageHasBeenLoaded: boolean;\r\n\tpublic tooltipRef:any;\r\n\tprivate data:stateInterface;\r\n\tprivate hColors: string[];\r\n\tconstructor(props: any) {\r\n\t\tsuper(props);\r\n\t\tthis.hColors = Array.from({length: 150}, () => `rgba(${randomColor()}, ${randomColor()}, ${randomColor()}, 0.4`);\r\n\t\tthis.tooltipRef = React.createRef();\r\n\t\tthis.imageHasBeenLoaded = false;\r\n\t\tthis.data = { bboxes:[], segments:[], descriptions:[]};\r\n\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.updateImage();\r\n\t}\r\n\r\n\thandleMouse(e:any){\r\n\t\tconst ctx = this.canvasForeground.getContext('2d');\r\n\t\tconst rect = this.canvasForeground.getBoundingClientRect();\r\n\t\tconst x = e.clientX - rect.left;\r\n\t\tconst y = e.clientY - rect.top;\r\n\t\tlet box;\r\n\t\tctx.clearRect(0, 0, this.canvasForeground.width, this.canvasForeground.height);\r\n\t\tlet i = 0;\r\n\r\n\t\tif(this.props.props.Image.showBboxes && this.props.props.Image.showKeypoints && this.imageHasBeenLoaded) {\r\n\t\t\tlet segment;\r\n\t\t\twhile (i < this.data.bboxes.length) {\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tbox = this.data.bboxes[i];\r\n\t\t\t\tsegment = this.data.segments[i];\r\n\r\n\t\t\t\tctx.rect(box[0], box[1], box[2], box[3]);\r\n\t\t\t\tconst RGBA = this.hColors[i].substr(0, this.hColors[i].length - 4) + ' 0.2)';\r\n\t\t\t\tif (ctx.isPointInPath(x, y)) {\r\n\t\t\t\t\tctx.fillStyle = RGBA;\r\n\t\t\t\t\tthis.tooltipRef.current.innerText = this.data.descriptions[i];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tctx.fillStyle = this.hColors[i];\r\n\t\t\t\t}\r\n\t\t\t\tctx.fill();\r\n\t\t\t\tctx.closePath();\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tfor(let z = 0; z < segment.length; z++) {\r\n\r\n\t\t\t\t\tctx.moveTo(segment[z][0], segment[z][1]);\r\n\r\n\t\t\t\t\tfor (let y = 0; y < segment[z].length; y += 2) {\r\n\t\t\t\t\t\tctx.lineTo(segment[z][y], segment[z][y + 1]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tctx.lineTo(segment[z][0], segment[z][1]);\r\n\t\t\t\t\tctx.lineWidth = 8;\r\n\t\t\t\t\tctx.stroke();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tctx.fill();\r\n\t\t\t\tctx.closePath();\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\r\n\t\t}else if(this.props.props.Image.showBboxes && this.imageHasBeenLoaded){\r\n\t\t\twhile (i < this.data.bboxes.length) {\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tbox = this.data.bboxes[i];\r\n\t\t\t\tctx.rect(box[0], box[1], box[2], box[3]);\r\n\t\t\t\tconst RGBA = this.hColors[i].substr(0, this.hColors[i].length - 4) + ' 0.2)';\r\n\t\t\t\tif (ctx.isPointInPath(x, y)) {\r\n\t\t\t\t\tctx.fillStyle = RGBA;\r\n\t\t\t\t\tthis.tooltipRef.current.innerText = this.data.descriptions[i];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tctx.fillStyle = this.hColors[i];\r\n\t\t\t\t}\r\n\t\t\t\tctx.fill();\r\n\t\t\t\tctx.closePath();\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\r\n\t\t}else if(this.props.props.Image.showKeypoints && this.imageHasBeenLoaded){\r\n\r\n\t\t\tlet segment;\r\n\t\t\tlet i = 0;\r\n\r\n\t\t\twhile (i < this.data.segments.length) {\r\n\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tconst RGBA = this.hColors[i].substr(0, this.hColors[i].length - 4) + ' 0.2)';\r\n\t\t\t\tsegment = this.data.segments[i];\r\n\r\n\t\t\t\tfor(let z = 0; z < segment.length; z++) {\r\n\r\n\t\t\t\t\tctx.moveTo(segment[z][0], segment[z][1]);\r\n\r\n\t\t\t\t\tfor (let y = 0; y < segment[z].length; y += 2) {\r\n\t\t\t\t\t\tctx.lineTo(segment[z][y], segment[z][y + 1]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tctx.lineTo(segment[z][0], segment[z][1]);\r\n\t\t\t\t\tctx.lineWidth = 8;\r\n\t\t\t\t\tctx.stroke();\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif (ctx.isPointInPath(x, y)) {\r\n\t\t\t\t\tctx.fillStyle = RGBA;\r\n\t\t\t\t\tthis.tooltipRef.current.innerText = this.data.descriptions[i];\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tctx.fillStyle = this.hColors[i];\r\n\t\t\t\t}\r\n\t\t\t\tctx.stroke();\r\n\t\t\t\tctx.fill();\r\n\t\t\t\tctx.closePath();\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tupdateImage(){\r\n\t\tthis.imageHasBeenLoaded = false;\r\n\t\tconst bboxes:number[][]=[];\r\n\t\tconst descriptions:string[] = [];\r\n\t\tconst imageObj1 = new Image();\r\n\t\timageObj1.src = this.props.props.Image.url;\r\n\t\timageObj1.onload = ()=> {\r\n\r\n\t\t\tconst ctx = this.canvas.getContext('2d');\r\n\t\t\tconst ctxForeground = this.canvasForeground.getContext('2d');\r\n\t\t\tctx.drawImage(imageObj1, 0, 0);\r\n\r\n\t\t\tif(this.props.props.Image.showBboxes && this.props.props.Image.showKeypoints) {\r\n\t\t\t\tconst segments:number[][][] = [];\r\n\r\n\t\t\t\tctxForeground.clearRect(0, 0, this.props.props.Image.width, this.props.props.Image.height);\r\n\t\t\t\tthis.props.props.Image.info.bboxes.forEach((bbox: any, index) => {\r\n\t\t\t\t\tconst fillColor = this.hColors[index];\r\n\t\t\t\t\tbboxes.push(bbox.box);\r\n\t\t\t\t\tdescriptions.push(bbox.category);\r\n\t\t\t\t\tctxForeground.fillStyle = fillColor;\r\n\t\t\t\t\tctxForeground.fillRect(bbox.box[0], bbox.box[1], bbox.box[2], bbox.box[3]);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.props.props.Image.info.segments.forEach((segment:any, index:number)=> {\r\n\r\n\t\t\t\t\tconst segmentData = segment.segments;\r\n\t\t\t\t\tconst subSegmenedToSegment= [];\r\n\t\t\t\t\tfor (let z = 0; z < segmentData.length; z++) {\r\n\t\t\t\t\t\tsubSegmenedToSegment.push(segmentData[z]);\r\n\t\t\t\t\t\tif (descriptions.length === 0) {\r\n\t\t\t\t\t\t\tdescriptions.push(segment.category);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tctxForeground.beginPath();\r\n\t\t\t\t\t\tctxForeground.moveTo(segmentData[z][0], segmentData[z][1]);\r\n\r\n\t\t\t\t\t\tfor (let i = 2; i < segmentData[z].length; i += 2) {\r\n\r\n\t\t\t\t\t\t\tctxForeground.lineTo(segmentData[z][i], segmentData[z][i + 1]);\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tctxForeground.lineTo(segmentData[z][0], segmentData[z][1]);\r\n\t\t\t\t\t\tctxForeground.lineWidth = 8;\r\n\t\t\t\t\t\tctxForeground.stroke();\r\n\t\t\t\t\t\tctxForeground.fillStyle = this.hColors[index];\r\n\t\t\t\t\t\tctxForeground.fill();\r\n\t\t\t\t\t\tctxForeground.beginPath();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tsegments.push(subSegmenedToSegment);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.data = { bboxes: bboxes, segments: segments, descriptions: descriptions };\r\n\r\n\t\t\t}else if(this.props.props.Image.showBboxes){\r\n\r\n\t\t\t\tctxForeground.clearRect(0, 0, this.props.props.Image.width, this.props.props.Image.height);\r\n\t\t\t\tthis.props.props.Image.info.bboxes.forEach((bbox: any, index) => {\r\n\t\t\t\t\tconst fillColor = this.hColors[index];\r\n\t\t\t\t\tbboxes.push(bbox.box);\r\n\t\t\t\t\tdescriptions.push(bbox.category);\r\n\t\t\t\t\tctxForeground.fillStyle = fillColor;\r\n\t\t\t\t\tctxForeground.fillRect(bbox.box[0], bbox.box[1], bbox.box[2], bbox.box[3]);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.data = { bboxes: bboxes, segments: this.data.segments, descriptions: descriptions };\r\n\r\n\t\t\t}else if(this.props.props.Image.showKeypoints){\r\n\r\n\t\t\t\tconst segments:number[][][] = [];\r\n\t\t\t\tctxForeground.clearRect(0, 0, this.props.props.Image.width, this.props.props.Image.height);\r\n\r\n\t\t\t\tthis.props.props.Image.info.segments.forEach((segment:any, index:number)=> {\r\n\r\n\t\t\t\t\tdescriptions.push(this.props.props.Image.info.segments[index].category);\r\n\t\t\t\t\tconst segmentData = segment.segments;\r\n\t\t\t\t\tconst subSegmenedToSegment= [];\r\n\t\t\t\t\tfor (let z = 0; z < segmentData.length; z++) {\r\n\t\t\t\t\t\tsubSegmenedToSegment.push(segmentData[z]);\r\n\t\t\t\t\t\tctxForeground.beginPath();\r\n\t\t\t\t\t\tctxForeground.moveTo(segmentData[z][0], segmentData[z][1]);\r\n\r\n\t\t\t\t\t\tfor (let i = 0; i < segmentData[z].length; i += 2) {\r\n\r\n\t\t\t\t\t\t\tctxForeground.lineTo(segmentData[z][i], segmentData[z][i + 1]);\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tctxForeground.lineTo(segmentData[z][0], segmentData[z][1]);\r\n\r\n\t\t\t\t\t\tctxForeground.lineWidth = 8;\r\n\t\t\t\t\t\tctxForeground.stroke();\r\n\t\t\t\t\t\tctxForeground.fillStyle = this.hColors[index];\r\n\t\t\t\t\t\tctxForeground.fill();\r\n\t\t\t\t\t\tctxForeground.closePath();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tsegments.push(subSegmenedToSegment);\r\n\t\t\t\t});\r\n\t\t\t\tthis.data = { bboxes: this.data.bboxes, segments: segments, descriptions: descriptions };\r\n\t\t\t}\r\n\r\n\t\t\telse{\r\n\t\t\t\tctxForeground.clearRect(0,0,this.props.props.Image.width,this.props.props.Image.height);\r\n\t\t\t}\r\n\r\n\t\t\tthis.imageHasBeenLoaded=true;\r\n\t\t};\r\n\t}\r\n\r\n\r\n\tcomponentDidUpdate(prevProps:props) {\r\n\r\n\t\tif(this.props.props.Image.showBboxes===true){\r\n\r\n\t\t\tthis.updateImage();\r\n\t\t}else{\r\n\r\n\t\t\tthis.updateImage();\r\n\t\t}\r\n\r\n\t\tif(this.props.props.Image.showKeypoints===true){\r\n\r\n\t\t\tthis.updateImage();\r\n\t\t}else{\r\n\r\n\t\t\tthis.updateImage();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<Row style={{ width: `${this.props.props.Image.width}px`}}>\r\n\t\t\t\t<OverlayTrigger placement={'bottom'} overlay={ <Tooltip id=\"tooltip-disabled\"><i ref={this.tooltipRef}> </i></Tooltip> } >\r\n\t\t\t\t\t<div className={'canvasStack'} style={{ display: 'flex'}}>\r\n\t\t\t\t\t\t<canvas style={{zIndex:1, objectFit: 'contain', width: '100%'}}   ref={(canvas)=>this.canvas=canvas} width={this.props.props.Image.width} height={this.props.props.Image.height}> </canvas>\r\n\t\t\t\t\t\t{/*<canvas style={{top: 0, objectFit: 'contain', width: '100%',zIndex:2, marginLeft:`-${this.props.props.Image.width}px`}} onMouseMove={this.handleMouse.bind(this)} ref={(canvas)=>this.canvasForeground=canvas} width={this.props.props.Image.width} height={this.props.props.Image.height}></canvas>*/}\r\n\t\t\t\t\t\t<canvas style={{top: 0, objectFit: 'contain', width: '100%',zIndex:2}} onMouseMove={this.handleMouse.bind(this)} ref={(canvas)=>this.canvasForeground=canvas} width={this.props.props.Image.width} height={this.props.props.Image.height}></canvas>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</OverlayTrigger>\r\n\t\t\t</Row>\r\n\t\t);\r\n\t}\r\n}\r\n"]},"metadata":{},"sourceType":"module"}
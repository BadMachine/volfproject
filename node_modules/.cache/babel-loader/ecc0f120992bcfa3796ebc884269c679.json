{"ast":null,"code":"\"use strict\";\n\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n      m = s && o[s],\n      i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function () {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spread = this && this.__spread || function () {\n  for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n\n  return ar;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar NodeUtil_js_1 = require(\"./NodeUtil.js\");\n\nvar Stack = function () {\n  function Stack(_factory, _env, inner) {\n    this._factory = _factory;\n    this._env = _env;\n    this.global = {};\n    this.stack = [];\n    this.global = {\n      isInner: inner\n    };\n    this.stack = [this._factory.create('start', this.global)];\n\n    if (_env) {\n      this.stack[0].env = _env;\n    }\n\n    this.env = this.stack[0].env;\n  }\n\n  Object.defineProperty(Stack.prototype, \"env\", {\n    get: function () {\n      return this._env;\n    },\n    set: function (env) {\n      this._env = env;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  Stack.prototype.Push = function () {\n    var e_1, _a;\n\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    try {\n      for (var args_1 = __values(args), args_1_1 = args_1.next(); !args_1_1.done; args_1_1 = args_1.next()) {\n        var node = args_1_1.value;\n\n        if (!node) {\n          continue;\n        }\n\n        var item = NodeUtil_js_1.default.isNode(node) ? this._factory.create('mml', node) : node;\n        item.global = this.global;\n\n        var _b = __read(this.stack.length ? this.Top().checkItem(item) : [null, true], 2),\n            top_1 = _b[0],\n            success = _b[1];\n\n        if (!success) {\n          continue;\n        }\n\n        if (top_1) {\n          this.Pop();\n          this.Push.apply(this, __spread(top_1));\n          continue;\n        }\n\n        this.stack.push(item);\n\n        if (item.env) {\n          if (item.copyEnv) {\n            Object.assign(item.env, this.env);\n          }\n\n          this.env = item.env;\n        } else {\n          item.env = this.env;\n        }\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (args_1_1 && !args_1_1.done && (_a = args_1.return)) _a.call(args_1);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n  };\n\n  Stack.prototype.Pop = function () {\n    var item = this.stack.pop();\n\n    if (!item.isOpen) {\n      delete item.env;\n    }\n\n    this.env = this.stack.length ? this.Top().env : {};\n    return item;\n  };\n\n  Stack.prototype.Top = function (n) {\n    if (n === void 0) {\n      n = 1;\n    }\n\n    return this.stack.length < n ? null : this.stack[this.stack.length - n];\n  };\n\n  Stack.prototype.Prev = function (noPop) {\n    var top = this.Top();\n    return noPop ? top.First : top.Pop();\n  };\n\n  Stack.prototype.toString = function () {\n    return 'stack[\\n  ' + this.stack.join('\\n  ') + '\\n]';\n  };\n\n  return Stack;\n}();\n\nexports.default = Stack;","map":{"version":3,"sources":["../../../ts/input/tex/Stack.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __values = (this && this.__values) || function(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n        next: function () {\n            if (o && i >= o.length) o = void 0;\n            return { value: o && o[i++], done: !o };\n        }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spread = (this && this.__spread) || function () {\n    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n    return ar;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar NodeUtil_js_1 = require(\"./NodeUtil.js\");\nvar Stack = (function () {\n    function Stack(_factory, _env, inner) {\n        this._factory = _factory;\n        this._env = _env;\n        this.global = {};\n        this.stack = [];\n        this.global = { isInner: inner };\n        this.stack = [this._factory.create('start', this.global)];\n        if (_env) {\n            this.stack[0].env = _env;\n        }\n        this.env = this.stack[0].env;\n    }\n    Object.defineProperty(Stack.prototype, \"env\", {\n        get: function () {\n            return this._env;\n        },\n        set: function (env) {\n            this._env = env;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Stack.prototype.Push = function () {\n        var e_1, _a;\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        try {\n            for (var args_1 = __values(args), args_1_1 = args_1.next(); !args_1_1.done; args_1_1 = args_1.next()) {\n                var node = args_1_1.value;\n                if (!node) {\n                    continue;\n                }\n                var item = NodeUtil_js_1.default.isNode(node) ?\n                    this._factory.create('mml', node) : node;\n                item.global = this.global;\n                var _b = __read(this.stack.length ? this.Top().checkItem(item) : [null, true], 2), top_1 = _b[0], success = _b[1];\n                if (!success) {\n                    continue;\n                }\n                if (top_1) {\n                    this.Pop();\n                    this.Push.apply(this, __spread(top_1));\n                    continue;\n                }\n                this.stack.push(item);\n                if (item.env) {\n                    if (item.copyEnv) {\n                        Object.assign(item.env, this.env);\n                    }\n                    this.env = item.env;\n                }\n                else {\n                    item.env = this.env;\n                }\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (args_1_1 && !args_1_1.done && (_a = args_1.return)) _a.call(args_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n    };\n    Stack.prototype.Pop = function () {\n        var item = this.stack.pop();\n        if (!item.isOpen) {\n            delete item.env;\n        }\n        this.env = (this.stack.length ? this.Top().env : {});\n        return item;\n    };\n    Stack.prototype.Top = function (n) {\n        if (n === void 0) { n = 1; }\n        return this.stack.length < n ? null : this.stack[this.stack.length - n];\n    };\n    Stack.prototype.Prev = function (noPop) {\n        var top = this.Top();\n        return noPop ? top.First : top.Pop();\n    };\n    Stack.prototype.toString = function () {\n        return 'stack[\\n  ' + this.stack.join('\\n  ') + '\\n]';\n    };\n    return Stack;\n}());\nexports.default = Stack;\n//# sourceMappingURL=Stack.js.map"]},"metadata":{},"sourceType":"script"}